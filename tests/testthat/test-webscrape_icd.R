context("test-webscrape_icd")

test_that("webscrape_icd() function works!", {
  icd10_2024 <- webscrape_icd(icd_version = "ICD10", year = 2024, quiet = TRUE)
  icd10_2023 <- webscrape_icd(icd_version = "ICD10", year = 2023, quiet = TRUE)
  icd10_2021 <- webscrape_icd(icd_version = "icd10", year = 2021, quiet = TRUE)
  icd10_2020 <- webscrape_icd(icd_version = "ICD10", year = 2020, quiet = TRUE)
  icd9_2014 <- webscrape_icd(icd_version = "ICD9", quiet = TRUE)
  expect_s3_class(icd10_2024, "data.frame")
  expect_s3_class(icd10_2023, "data.frame")
  expect_s3_class(icd10_2021, "data.frame")
  expect_s3_class(icd10_2020, "data.frame")
  expect_s3_class(icd9_2014, "data.frame")
  expect_error(webscrape_icd("icd10", quiet = TRUE))
  expect_error(webscrape_icd("ICD11", quiet = TRUE))
  expect_error(webscrape_icd("ICD10", year = 2014, quiet = TRUE))
  expect_error(webscrape_icd("ICD9", year = 2020, quiet = TRUE))
  expect_error(webscrape_icd("ICD10", year = 2017, quiet = TRUE))
  expect_error(webscrape_icd("ICD10", year = 2100, quiet = TRUE))
  expect_error(webscrape_icd("ICD10", quiet = TRUE))
})
